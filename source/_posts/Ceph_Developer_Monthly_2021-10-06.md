---
title: "Ceph Developer Monthly 2021-10-06"
date: 2021-10-08
updated: 2021-10-09
tags:
categories:
- "视频总结"
subtitle: tech
---


### 会议纪要

#### 会议主题：Ceph 十月会议

#### 主要议题：
1. **遥测与性能信息**
2. **SMR 驱动器的 Boost 支持**
3. **RBD 镜像公主集成**

#### 讨论内容：

##### 1. 遥测与性能信息
- **背景**：遥测模块收集用户集群的匿名数据，用于帮助开发者了解集群使用情况和识别问题。
- **性能通道（Perf Channel）**：
  - **收集内容**：包括性能计数器、OSD 性能直方图、I/O 速率、每个池的统计总和等。
  - **目的**：帮助开发者理解集群整体使用情况，发现操作分布，识别集群使用变化，以及系统是否按预期执行。
  - **客户用途**：客户可以使用性能通道来揭示集群整体健康状况的详细上下文，识别工作负载模式，故障排除延迟、限流或内存管理问题，以及监控集群性能。
- **决定事项**：
  - 决定从按池收集改为按单个 PG 级别收集统计总和。
  - 移除池名称以保护匿名性。
- **后续行动**：
  - 添加新的指标如 mempool 和 RocksDB 压缩统计。
  - 讨论数据不可用性的检测和相关指标的收集。

##### 2. SMR 驱动器的 Boost 支持
- **当前状态**：内部元数据跟踪已实现，简单清理器已实现，Boost 可以在 SMR 硬盘上成功运行。
- **下一步**：
  - 确定如何构建，考虑是否添加 libzbd 库依赖。
  - 实现更智能的清理策略。
  - 考虑如何使用常规区域，可能让 BlueFS 使用顺序区域。
  - 解决 fs_check 中的内存使用问题。
  - 为 SMR 驱动器创建不同的 OSD 类别。

##### 3. RBD 镜像公主集成
- **目标**：启用用户监控异步复制的健康状况，检测异常，并提供跨集群复制的统一方式来传递指标和警报。
- **实现方式**：使用 Prometheus 作为消费者，通过 HTTP 端点暴露指标。
- **挑战与决定**：
  - 考虑使用 Prometheus C++ 库或自定义实现。
  - 讨论了高可用性、安全性和服务发现的问题。
  - 决定不引入新的 Web 服务器模块，而是考虑使用 Boost Beast。

#### 后续行动计划：
- 完成遥测模块的改进，特别是性能通道的指标收集和数据不可用性的检测。
- 继续 SMR 驱动器支持的工作，包括构建和清理策略的优化。
- 推进 RBD 镜像集成的工作，特别是 Prometheus 端点的实现和统一指标的制定。

#### 结论：
会议讨论了多个关于 Ceph 的重要议题，包括遥测、性能优化、SMR 驱动器支持和 RBD 镜像集成。每个议题都有明确的下一步行动计划，旨在提高 Ceph 的性能和可用性。