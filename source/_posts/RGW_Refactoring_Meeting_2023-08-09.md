---
title: "RGW Refactoring Meeting 2023-08-09"
date: 2023-08-15
updated: 2023-08-16
tags:
categories:
- "视频总结"
subtitle: tech
---


### 会议纪要

#### 会议概要
- **Reef版本发布**：Reef版本已于今日发布，感谢所有人的辛勤工作。
- **博客文章计划**：将开始发布博客文章来宣布新功能。如果有团队成员在Reef版本中开发了新功能并希望与社区分享，请与负责人联系。

#### 主要议题
- **Yuval关于通知的讨论**：
  - **持久化通知改进**：目标是提高持久化通知的观察性和可调试性。
    - **当前进展**：Ali之前的工作已经使得在RedEscape Admin中可以运行命令查询特定持久化队列的状态或统计信息。
    - **下一步计划**：
      - 使用带标签的性能计数器（labeled perf counters）在Redis Gateway Admin上，以便在部署中更方便地收集统计信息并展示在Grafana等工具中。
      - 改进重试机制，包括为每个通知设置TTL和重试次数，以避免无限重试和队列过大问题。
      - 使配置RESTful化，以便不同主题可以指向不同的系统并具有不同的特性。
      - 在迁移过程中，确保重试次数和TTL的持久性，特别是在升级到支持TTL的版本时。

  - **迁移到CLS FIFO**：
    - **动机**：当前队列的最大大小为128MB，对于长时间的服务器宕机或高更新率的系统可能不够。
    - **挑战**：
      - 迁移问题：可能需要同时维护两个队列，直到旧队列中的数据处理完毕。
      - 观察性问题：CLS FIFO可能难以提供准确的队列条目数和大小，可能需要遍历所有节点来获取这些信息。
      - 上限问题：可能需要为FIFO设置一个上限，以防止无限制增长。

  - **讨论要点**：
    - 是否需要一个死信队列（dead letter queue）来处理无法发送的通知。
    - 如何处理TTL和重试在CLS FIFO中的实现问题。
    - 迁移策略：建议通过创建新主题并逐步迁移来避免复杂的迁移过程。

#### 决定事项
- 将继续改进持久化通知的观察性和重试机制。
- 考虑迁移到CLS FIFO以支持更大的队列大小。
- 讨论并决定如何处理迁移和死信队列的问题。

#### 后续行动计划
- 继续开发和测试持久化通知的改进功能。
- 研究并实施迁移到CLS FIFO的策略。
- 提供脚本帮助用户迁移到新主题。
- 讨论并决定是否需要实现死信队列。

#### 其他讨论
- 关于将S3用户与主题关联的提议，以便更容易管理用户和主题的关系。

#### 会议结束
- 会议结束，感谢所有参与者的贡献和讨论。