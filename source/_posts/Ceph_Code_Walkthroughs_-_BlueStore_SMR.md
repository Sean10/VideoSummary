---
title: "Ceph Code Walkthroughs: BlueStore SMR"
date: 2021-08-21
updated: 2021-08-21
tags:
categories:
- "视频总结"
subtitle: tech
---


### 会议纪要

#### 会议主题：Ceph存储系统中SMR（Shingled Magnetic Recording）智能驱动器的代码更新与讨论

#### 参会人员：Ceph研发团队成员

#### 会议时间：[具体日期]

#### 会议地点：视频会议

#### 主要议题：
1. **SMR智能驱动器的代码更新**
   - 讨论了针对HSM（Host-Managed SMR）智能驱动器的代码更新，包括内核设备的支持和SMR特定功能的添加。
   - 介绍了如何通过SMART特定调用来获取设备上的区域信息，如区域数量和传统区域数量。

2. **Zoned Allocator和Zone Freelist Manager的更新**
   - 详细讨论了Zoned Allocator和Zone Freelist Manager的实现细节，包括新的清理线程的添加和设备参数的处理。
   - 讨论了如何处理对象的区域编号和偏移量，以及如何在数据库中维护这些信息。

3. **代码优化和未来工作**
   - 讨论了是否需要继续使用ZBD库以保持对旧内核的兼容性，以及是否需要紧急移除它。
   - 讨论了如何处理多区域同时清理的问题，以及如何简化这一过程。

#### 决定事项：
- **ZBD库的使用**：决定不紧急移除ZBD库，以保持对旧内核的兼容性。
- **多区域清理**：决定简化多区域清理过程，每次只清理一个区域，以减少复杂性和潜在的错误。

#### 后续行动计划：
- **代码审查和优化**：对现有代码进行详细审查，特别是Zoned Allocator和Zone Freelist Manager的实现，确保其正确性和效率。
- **兼容性测试**：在不同内核版本上进行兼容性测试，确保代码在各种环境下都能稳定运行。
- **文档更新**：更新相关文档，包括代码注释和用户手册，以便其他开发者更好地理解和维护代码。

#### 备注：
- 会议中提到的“zone append”命令是一个新的内核命令，用于简化SMR驱动器的写操作。
- 会议结束时，团队成员表示将通过电子邮件跟进会议中提到的待办事项。

#### 会议总结：
本次会议主要讨论了Ceph存储系统中SMR智能驱动器的代码更新和优化问题，团队成员对现有代码进行了深入的讨论，并制定了后续的行动计划。通过本次会议，团队对SMR驱动器的支持有了更清晰的认识和规划。