---
title: "CDS Reef: Crimson"
date: 2022-04-22
updated: 2022-04-23
tags:
categories:
- "视频总结"
subtitle: tech
---


会议主要讨论了Crimson CDF项目2022年的进展，重点关注Quincy版本的稳定性和部署情况，以及Reef版本的开发重点。具体内容如下：

1. **Quincy版本**：
   - 过去一年的主要工作集中在稳定性和部署上。
   - Crimson现在支持Rook、SAFE和Seth ADM进行部署。
   - 开发了初步的Crimson RADOS技术套件，并进行了故障注入测试。
   - 对发现的问题进行了大量修复，特别是在排序和watch notify API方面。
   - 改进了Blue Stores的支持。

2. **C-Store**：
   - 引入了新的指标框架，以更好地理解C-Store的行为。
   - 对C-Store内部进行了重写，简化了LBA树结构，增加了非日志段存储扩展的能力。
   - 冲突检测机制使用可中断的未来重写。
   - 添加了初始DNS支持，ZNS段管理器已在真实的DNS设备上测试。
   - 在性能方面，对LBA提示和日志合并进行了改进。

3. **Reef版本**：
   - 多核快照和清理是Reef的重点，特别是清理功能对于其他组件的信心至关重要。
   - 将针对C-Store进行大量工作，包括多设备和分层的进一步改进，特别是与垃圾回收相关。
   - 支持通过Random Block Manager快速访问NVMe设备。
   - 最初通过在静态磁盘分区上运行多个C-Store实例来处理多核问题。

4. **测试和部署**：
   - Quincy应该支持在单Reactor配置中测试RBD工作负载，无需快照，后端可以是Blue Store、Cyan Store或C Store，使用Rook或Seth ADM部署。
   - 需要选择一种病理学测试作为所有PR的门槛测试，以确保Crimson持续有效。

5. **调试子系统**：
   - 需要使Crimson的日志记录方式与Classic一致。
   - 应尊重Classic的debug_underscore配置选项。
   - PG日志消息应保持一致性，便于抓取特定PG的所有日志行。

6. **垃圾回收策略讨论**：
   - 介绍了基于代数的垃圾回收策略，目的是将相似特性和年龄的扩展存储在同一段中。
   - 讨论了代数的概念，即扩展可以存储在具有相同特性和类似年龄的段中。
   - 提出了对策略的担忧和可能的改进建议，如直接将冷扩展写入更高代数。

7. **后续行动计划**：
   - 继续改进C Store的成熟度，尽管可能会落后于Crimson整体进度。
   - 探索更频繁的发布周期，如每月或每周自动构建快照，以便社区成员下载和运行。
   - 推动与更广泛的社区合作，改善发布流程，并考虑为新贡献者编写指令和修复错误。