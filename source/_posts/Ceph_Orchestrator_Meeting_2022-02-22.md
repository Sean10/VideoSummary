---
title: "Ceph Orchestrator Meeting 2022-02-22"
date: 2022-02-22
updated: 2022-02-23
tags:
categories:
- "视频总结"
subtitle: tech
---


### 会议纪要

#### 会议主题：Ceph存储系统中的缓存对象问题及Prometheus监控配置讨论

#### 关键细节：
1. **主机缓存对象问题**：
   - 当前存在主机缓存对象过大的问题，这些对象包含了主机的详细信息，如使用的磁盘等。
   - 这些信息被存储在一个大的Python对象中，然后转换为JSON对象存储在Monkey Store中。
   - Monkey Store的默认最大大小为56KB，某些配置密集的主机可能会超出此限制，导致后台故障。
   - 提出的解决方案包括：
     - 增加Monkey Store的大小限制。
     - 将主机缓存对象分割为多个较小的对象，特别是将设备信息单独存储，以避免单个对象过大。
     - 考虑数据压缩，如使用gzip压缩JSON数据，以减少存储需求。

2. **配置和密钥环存储位置**：
   - 讨论了将配置和密钥环从当前的Etsy Stuff存储位置迁移到var/lib/fsid目录下的可能性。
   - 目的是使这些文件与集群ID更紧密地关联，便于管理和推理。
   - 提出了在两个位置同时存储的方案，以避免复杂的迁移过程，并允许用户自定义存储位置。

3. **Prometheus版本升级**：
   - 讨论了升级Prometheus版本的需求，特别是为了支持外部Prometheus实例的功能。
   - 建议从当前版本升级到2.28，以利用新功能并简化配置。

4. **支持外部Prometheus实例**：
   - 讨论了如何支持用户使用外部的Prometheus实例来监控Ceph集群。
   - 提出的方案是在Ceph中创建一个端点，外部Prometheus实例可以通过该端点获取配置信息。

5. **Prometheus高可用性（HA）配置**：
   - 讨论了使用RBD图像来存储Prometheus的配置和数据，以实现高可用性。
   - 提出了多个潜在问题，包括依赖集群本身的可用性、数据写入的复杂性以及存储需求等。

#### 决定事项：
- 对于主机缓存对象问题，决定探索分割缓存对象和数据压缩的解决方案。
- 对于配置和密钥环存储位置，决定支持在两个位置同时存储的方案。
- 对于Prometheus版本升级，决定进一步研究和测试新版本的可行性。
- 对于支持外部Prometheus实例，决定创建一个端点供外部实例获取配置信息。
- 对于Prometheus HA配置，决定进一步讨论和评估其可行性和潜在问题。

#### 后续行动计划：
- 实施主机缓存对象分割和数据压缩的方案，并进行测试。
- 实现配置和密钥环在两个位置同时存储的功能。
- 进行Prometheus版本升级的测试和验证。
- 开发并测试外部Prometheus实例的端点支持。
- 进一步讨论和评估Prometheus HA配置的可行性，并考虑潜在的改进措施。

#### 会议结束：
- 会议在讨论完所有议题后结束，无其他待讨论事项。
- 下次会议预定在下周进行。

---

以上是本次会议的详细纪要，涵盖了会议的关键细节、讨论的主要议题、决定的事项以及后续的行动计划。