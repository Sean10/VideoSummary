---
title: "Ceph Orchestrator Meeting 2021-09-07"
date: 2021-09-11
updated: 2021-09-12
tags:
categories:
- "视频总结"
subtitle: tech
---


### 会议纪要

#### 会议主题：本周的Orchestrator周会

#### 参会人员：全体成员

#### 会议时间：本周

#### 主要议题：
1. **Agent介绍** - 由Edin进行
2. **Repaving Oasis** - 由Cory进行
3. **测试重启**
4. **日志聚合需求**

#### 会议内容总结：

##### 1. Agent介绍
- **目的**：提高可扩展性和性能，解决当前使用SSH通信的慢速问题。
- **架构**：
  - 管理器将有一个HTTP端点，使用CherryPy。
  - 主机上的Agent将是一个非容器化的systemd单元，直接在主机上运行命令。
  - Agent将通过HTTP将收集的所有数据发送到管理器。
  - 管理器和Agent之间通过原始套接字通信。
- **安全性**：
  - 需要确保消息加密和身份验证，防止消息被窃听和伪造。
  - 使用HTTPS和自签名证书来确保通信安全。
  - 使用密钥环进行身份验证。
- **元数据完整性**：
  - 需要确保元数据是最新的，避免重复部署守护进程。
  - 使用计数器来确保元数据的时效性。
- **离线主机处理**：
  - 通过超时机制快速检测离线主机。
  - 重新部署Agent以验证主机状态。

##### 2. Repaving Oasis
- **目的**：自动化OSD的重铺过程，例如更改最小分配大小或使用db wal。
- **方法**：
  - 使用现有的驱动组定义来重新部署OSD。
  - 确保设备在释放后能被正确重新部署。
- **命令**：
  - 设想一个新的命令来启动重铺过程，例如`ceph osd repave`。
- **测试**：
  - 需要验证在混合OSD（SSD和硬盘）情况下的正确行为。

##### 3. 测试重启
- **目的**：避免在重启过程中出现Monmap问题。
- **方法**：
  - 使用现有的压力测试工具（如Thrasher）来测试重启过程。

##### 4. 日志聚合需求
- **目的**：聚合集群中的日志，可能用于支持案例。
- **讨论**：
  - 对于是否需要在管理器模块中实现日志聚合存在分歧。
  - 建议使用外部工具（如EFK堆栈）来处理日志聚合。

#### 决定事项：
- Agent的架构和安全性细节已经明确，后续将进行进一步的开发和测试。
- Repaving Oasis的初步方案已经提出，Cory将开始进行详细设计和开发。
- 重启测试将使用现有的压力测试工具进行。
- 日志聚合可能通过外部工具实现，而不是在管理器模块中。

#### 后续行动计划：
- Edin将继续开发和完善Agent的功能。
- Cory将开始Repaving Oasis的详细设计和开发工作。
- 使用Thrasher进行重启测试。
- 考虑使用外部工具进行日志聚合，并可能提供相关文档。

#### 会议结束：
感谢大家的参与，下次会议再见。

---

以上是本次会议的详细纪要，涵盖了会议的关键细节、讨论的主要议题、决定的事项以及后续的行动计划。