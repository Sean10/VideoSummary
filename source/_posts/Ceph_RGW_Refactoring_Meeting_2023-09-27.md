---
title: "Ceph RGW Refactoring Meeting 2023-09-27"
date: 2023-10-04
updated: 2023-10-05
tags:
categories:
- "视频总结"
subtitle: tech
---


### 会议纪要

#### 议题一：Coverity 项目更新
**汇报人：** Vidansh  
**参与人员：** Yuan 等  
**时间：** 过去两个月  
**内容：**
- **Coverity 工具介绍：** Coverity 是一个静态分析工具，用于识别代码中的问题，并将其分类为高、中、低影响。
- **项目成果：** 在过去的几个月中，团队成功解决了多个高、中影响的问题，并对工具的有效性进行了数据分析。
- **问题分类：**
  - **关键问题：** 40个，几乎与误报数量相等。
  - **误报：** 约40%的问题被归类为误报。
  - **其他分类：** 包括实际但不值得立即修复的bug和其他类别。
- **主要bug类型：** 除了未处理的异常外，主要问题包括空引用、内存泄漏、未初始化的变量等。
- **项目目标：** 提高rgw代码质量，并为社区提供关于Coverity工具有效性的数据，以决定是否将其纳入常规工作流程。
- **后续行动：** 需要进一步讨论是否自动化该过程或将其作为CI的一部分，以防止bug再次出现。

#### 议题二：多站点数据日志和bi日志竞态条件
**汇报人：** Jane  
**内容：**
- **问题识别：** 在多站点复制过程中发现了数据日志和bi日志的竞态条件问题。
- **具体问题：**
  - **数据日志窗口优化：** 当前实现中，数据日志更新在窗口内被缓存，可能导致更新丢失。
  - **异步操作问题：** 对象更新完成后，异步发送bucket complete操作可能导致数据不一致。
- **解决方案讨论：**
  - **数据日志更新：** 建议在bucket index完成处理后进行数据日志更新。
  - **性能影响：** 讨论了移除数据日志窗口优化可能对性能的影响。
- **后续行动：** 需要进一步测试和代码审查，以确定最佳解决方案。

#### 议题三：通知系统更新
**汇报人：** Krunal  
**内容：**
- **问题描述：** 在实现IAM策略或通知时，发现当前实现方式可能导致策略被覆盖。
- **当前实现：** 使用create topic API来更新主题属性，但未实现set topic attributes API。
- **讨论结果：**
  - **新系统行为：** 建议实现set topic attributes API，以允许用户在不覆盖策略的情况下更新主题属性。
  - **兼容性问题：** 需要确保现有系统不会因升级而中断，同时为新系统提供正确的API使用指南。
- **后续行动：** 将文档化新行为，并在PR中进行相应更新。

#### 总结
会议涵盖了Coverity工具的有效性分析、多站点数据日志和bi日志的竞态条件问题以及通知系统的更新。每个议题都有具体的讨论和后续行动计划，旨在提高代码质量和系统稳定性。感谢所有参与者的贡献和讨论。