---
title: "Ceph RGW Refactoring Meeting 2023-05-10"
date: 2023-05-10
updated: 2023-05-11
tags:
categories:
- "视频总结"
subtitle: tech
---


### 会议纪要

#### 会议主题：Kafka库实现及代码走查讨论

#### 与会人员：Yuval, Daniel, Thomas 等

#### 会议时间：具体日期未提供

#### 主要议题：

1. **Kafka库实现问题讨论**
   - **问题背景**：用户报告在使用Kafka库时遇到回归问题，特别是在设置ACK级别时。用户发现，尽管设置了ACK级别为“none”，但在某些条件下仍会进行重试。
   - **问题分析**：Yuval深入分析后发现，问题源于Kafka库内部的重试机制与我们的代码库中实现的重试机制冲突。我们的重试机制需要能够应对崩溃和重启等情况，而Kafka库的重试机制则是内存中的，无法持久化。
   - **解决方案讨论**：
     - Yuval建议尝试禁用Kafka库内部的重试机制，以避免设计上的混乱。
     - 讨论了是否应该禁用Kafka库的重试机制，特别是在ACK级别为“none”时。
     - 提出了是否应该允许用户通过配置文件来控制Kafka库的某些行为，以增加灵活性。
     - 最终决定，对于ACK级别为“broker”的情况，可以允许Kafka库进行内部重试，因为这更节省时间；而对于ACK级别为“none”的情况，则应禁用Kafka库的重试机制，以保持一致性和简化文档。

2. **代码走查提议**
   - **提议人**：Daniel
   - **提议内容**：提议进行代码走查，以传播关于rgw代码库的知识。特别提到了对tracing和Lua代码的走查。
   - **反馈**：Yuval表示对tracing的代码走查感兴趣，但希望在OSD编码问题解决后再进行。Thomas表示愿意进行Lua代码的走查。

#### 决定事项：

- 对于Kafka库的重试机制，决定在ACK级别为“broker”时允许内部重试，而在ACK级别为“none”时禁用内部重试。
- 允许用户通过配置文件来控制Kafka库的某些行为，以增加灵活性。
- 计划进行代码走查，特别是关于tracing和Lua代码的走查。

#### 后续行动计划：

- Yuval将根据讨论结果，对Kafka库的重试机制进行调整，并提交相关PR。
- Daniel和Thomas将准备进行代码走查，具体时间待定。
- 需要关注OSD编码问题的解决进展，以便进行tracing的代码走查。

#### 会议结束：感谢所有参与者的贡献，会议圆满结束。