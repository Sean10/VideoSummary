---
title: "Ceph Developer Monthly 2021-09-01"
date: 2021-09-02
updated: 2021-09-03
tags:
categories:
- "视频总结"
subtitle: tech
---


### 会议纪要

#### 会议主题：Ceph 配置文件与性能优化

**讨论内容：**
1. **配置文件（Config Profiles）**
   - **背景**：当前Ceph默认配置适用于高性能服务器，但越来越多的用户在资源受限的环境中部署Ceph，如家庭爱好集群、企业边缘部署等。
   - **提议**：引入性能配置文件，如“边缘资源受限”和“高性能”配置文件，自动调整CPU和内存使用等参数。
   - **实现**：类似于Pacific中的服务质量配置文件，通过设置一个主配置选项来控制多个子配置参数。
   - **讨论**：配置文件应如何设计，是否允许用户自定义配置文件，以及如何在Ceph配置系统中实现这些配置文件。

**决定事项：**
- 初步确定至少两个配置文件：“边缘资源受限”和“高性能”。
- 配置文件将通过设置一个主配置选项来控制多个子配置参数，类似于Pacific中的服务质量配置文件。
- 需要进一步讨论和实验来确定具体的配置参数和默认值。

**后续行动计划：**
- 设计并实现配置文件系统。
- 进行实验以确定最佳的配置参数。
- 与社区讨论并收集反馈，特别是关于用户自定义配置文件的需求。

#### 会议主题：处理无复制池的客户端EIO问题

**讨论内容：**
2. **无复制池的客户端EIO问题**
   - **背景**：在无复制池中，如果底层存储设备失败，客户端（如RBD）可能无法正确处理EIO错误，导致文件系统损坏。
   - **提议**：引入一个池级别的EIO标志，一旦设置，客户端将立即返回EIO错误，而不是挂起。
   - **实现**：通过OSD Map中的一个标志来实现，客户端检测到该标志后立即返回EIO错误。
   - **讨论**：如何确保客户端和服务端的一致性，以及如何处理多客户端情况下的同步问题。

**决定事项：**
- 引入池级别的EIO标志，客户端检测到该标志后立即返回EIO错误。
- 需要确保客户端和服务端的一致性，特别是在多客户端环境下。
- 需要进一步讨论和实验来确定具体的实现细节。

**后续行动计划：**
- 设计并实现池级别的EIO标志。
- 进行实验以验证客户端和服务端的一致性。
- 与社区讨论并收集反馈，特别是关于多客户端环境下的同步问题。

#### 会议主题：大规模集群测试

**讨论内容：**
3. **大规模集群测试**
   - **背景**：为了测试Ceph在超大规模集群中的性能和稳定性，需要一种方法在不实际部署大量物理硬件的情况下进行测试。
   - **提议**：使用内存 backed OSDs 和模拟数据存储来模拟大规模集群环境。
   - **实现**：通过调整OSD的配置和使用模拟数据存储来减少内存和存储需求。
   - **讨论**：如何平衡模拟环境的准确性和实际测试需求。

**决定事项：**
- 使用内存 backed OSDs 和模拟数据存储来模拟大规模集群环境。
- 需要进一步讨论和实验来确定具体的配置参数和模拟方法。

**后续行动计划：**
- 设计并实现内存 backed OSDs 和模拟数据存储。
- 进行实验以验证模拟环境的准确性和实际测试需求。
- 与社区讨论并收集反馈，特别是关于模拟环境的准确性和实际测试需求。

### 总结
本次会议主要讨论了Ceph在不同环境下的配置优化、无复制池的客户端EIO问题处理以及大规模集群测试的方法。决定引入性能配置文件、池级别的EIO标志和模拟数据存储来解决这些问题，并计划进行进一步的实验和社区讨论以完善这些方案。