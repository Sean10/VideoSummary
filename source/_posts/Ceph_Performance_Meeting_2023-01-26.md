---
title: "Ceph Performance Meeting 2023-01-26"
date: 2023-01-31
updated: 2023-02-01
tags:
categories:
- "视频总结"
subtitle: tech
---


### 会议纪要

#### 主要议题
1. **Etherpad 归档问题**：
   - 每年都会将Etherpad内容归档到前一年的文档中并重新开始。
   - 发现一个配置问题导致复制粘贴操作在服务器端 silently fails，导致2021年的记录丢失。
   - 2022年的记录已通过本地保存的副本恢复。
   - 已调整服务器缓冲区大小，以防止未来再次发生类似问题。

2. **新Pull Request讨论**：
   - 来自Igor的两个新PR：
     - 第一个PR涉及在多块读取时不重置预取缓冲区，讨论了其在性能统计上的改进，但实际性能提升不明显。
     - 第二个PR关于在飞行中启用RocksDB删除操作，讨论了其在实验中的应用和潜在的改进。
   - 其他PR包括启用4K分配单元、用户边界迭代器等，讨论了其对性能的影响和后续的QA需求。

3. **延迟峰值问题**：
   - 讨论了在升级到Pacific版本后出现的延迟峰值问题，最终确定是由于消息传递层的throttle机制导致的。
   - 该throttle机制在Nautilus版本中被禁用，但在Pacific版本中被重新启用，导致了一些性能问题。
   - 通过调整throttle设置和禁用该机制，延迟问题得到了改善。

4. **写放大问题**：
   - 讨论了写放大问题，通过perf dump数据分析，发现升级到Pacific后，写操作的平均大小有所增加。
   - 讨论了可能的原因，包括碎片化和元数据增加等，但尚未找到确切的原因。
   - 提出了进一步分析RocksDB日志和监控数据的建议。

#### 决定事项
- 调整Etherpad归档流程，确保未来不再丢失记录。
- 继续审查和测试新的Pull Request，特别是涉及性能改进的PR。
- 解决延迟峰值问题，通过调整或禁用throttle机制来优化性能。
- 进一步分析写放大问题，通过详细的日志分析和监控数据来寻找根本原因。

#### 后续行动计划
- 完成对新PR的审查和测试，确保其对性能的影响得到充分评估。
- 继续监控和分析延迟峰值问题，确保所有相关设置和配置都已优化。
- 深入分析写放大问题，包括RocksDB日志和性能统计数据，以确定问题的根本原因并提出解决方案。
- 定期回顾和更新Etherpad归档流程，确保数据的安全性和完整性。

### 结论
本次会议讨论了多个关键议题，包括Etherpad归档问题、新Pull Request的审查、延迟峰值问题和写放大问题。通过详细的讨论和分析，团队确定了后续的行动计划，并将继续监控和优化系统性能。感谢所有参与者的贡献和努力。