---
title: "Optimize Ceph messenger Performance"
date: 2022-11-15
updated: 2022-11-15
tags:
categories:
- "视频总结"
subtitle: tech
---


### 会议纪要

#### 关键细节与讨论议题

1. **APK vs TCP 性能优化**
   - 讨论了APK与TCP在性能优化方面的比较。
   - 进行了压缩测试，使用了Snappy压缩算法。
   - 结果显示，RDMA在某些测试中并未显示出比TCP明显的优势。

2. **Crimson与Seastar集成问题**
   - 讨论了启用Crimson与Seastar时遇到的一些问题。
   - 测试了经典OSD消息的处理，使用了RDMA作为公共网络，TCP作为集群网络。
   - 发现了一些网络配置和性能问题，特别是在高并发情况下。

3. **LSE（Large System Extensions）优化**
   - 介绍了LSE在8.1版本中的新特性，如何在L1缓存中加载和修改原子变量以减少缓存一致性成本。
   - 测试结果显示，启用LSE可以显著提高高并发环境下的性能。

4. **多工作负载平衡器**
   - 实现了一个新的多工作负载平衡器，用于优化工作负载的分配。
   - 通过迁移最优连接，重新平衡工作负载，提高了序列写入的性能。

5. **内核中的零拷贝技术**
   - 在内核中实现了动态零拷贝技术，减少了内存拷贝的开销。
   - 通过动态选择数据大小，优化了性能。

6. **Ceph消息处理优化**
   - 讨论了Ceph消息处理的一些优化措施，包括使用RDMA和TCP的比较。
   - 发现了一些网络配置和性能问题，特别是在高并发情况下。

#### 决定事项

- 决定继续优化APK与TCP的性能，特别是在压缩和网络配置方面。
- 决定继续改进Crimson与Seastar的集成，解决已知的问题。
- 决定继续优化LSE的使用，以提高高并发环境下的性能。
- 决定继续改进多工作负载平衡器，以优化工作负载的分配。
- 决定继续优化内核中的零拷贝技术，减少内存拷贝的开销。

#### 后续行动计划

- 继续进行APK与TCP的性能测试，优化网络配置和压缩算法。
- 继续解决Crimson与Seastar集成中的问题，优化高并发环境下的性能。
- 继续优化LSE的使用，提高高并发环境下的性能。
- 继续改进多工作负载平衡器，优化工作负载的分配。
- 继续优化内核中的零拷贝技术，减少内存拷贝的开销。

#### 其他讨论

- 讨论了Ceph消息处理的一些优化措施，包括使用RDMA和TCP的比较。
- 发现了一些网络配置和性能问题，特别是在高并发情况下。

#### 结论

- RDMA在某些测试中并未显示出比TCP明显的优势。
- 启用LSE可以显著提高高并发环境下的性能。
- 多工作负载平衡器和零拷贝技术的优化可以显著提高性能。

#### 问题与建议

- 需要继续优化网络配置和压缩算法，以提高性能。
- 需要继续解决Crimson与Seastar集成中的问题，优化高并发环境下的性能。
- 需要继续优化LSE的使用，提高高并发环境下的性能。
- 需要继续改进多工作负载平衡器，优化工作负载的分配。
- 需要继续优化内核中的零拷贝技术，减少内存拷贝的开销。

#### 会议结束

- 会议结束前，讨论了后续的工作计划和需要解决的问题。
- 需要继续与社区合作，改进Ceph的性能和功能。

#### 提问环节

- 会议结束前，进行了提问环节，讨论了一些具体的技术问题和建议。

---

以上是本次会议的纪要，涵盖了会议的关键细节、讨论的主要议题、决定的事项以及后续的行动计划。