---
title: "Ceph Performance Meeting 2022-06-23"
date: 2022-06-27
updated: 2022-06-28
tags:
categories:
- "视频总结"
subtitle: tech
---


会议纪要：

1. 更新情况：
   - 第一个更新是关于移除`statifus`的，Adam已经审查并通过了该更新，Igor进行了一些额外的修改，目前看起来进展顺利，但仍需要核心团队进行再次审查。
   - 第二个更新是关于将`kodell`添加到Blue Store中以缓解缓冲区膨胀问题，Sam在上周有机会对其进行了审查并提出了多项更改请求，该更新尚未准备就绪，仍在积极审查中。

2. 讨论主题：
   - 讨论了RocksDB调优问题，发现过去几年中出现的RocksDB调优方法虽然增加了内存缓冲区的数量并减小了其大小，同时允许累积两次写入再刷新到数据库中，但存在一些问题。最近几周的测试显示，这种调优实际上产生了相当稳定的效果，并没有看到预期中的放大增加。进一步的调整表明，通过调整Level 0和Level 1，并使用更多较小的缓冲区累积成较大的刷新，可以在不显著增加写放大的情况下提高RBD性能。
   - 正在研究经典OSD中的分片和线程行为，有证据表明当OSD分片为空时，效率会显著下降。这可能与唤醒所有线程的方式有关。这方面的分析和工作将在其他文章完成后继续进行。

3. Gabby报告：
   - Gabby正在重写Snapmapper的全部代码。在理解Snapmarker内部的数据结构和操作后，他意识到当前版本仅适用于存储长期数据，而实际中似乎并非如此。新的版本将尝试将所有内容存储在内存中，并按Snap ID和PG确定存储库的使用，优化数据结构从Red-Black树变为哈希表，使用Snap ID和Edge对象而非字符串。这将节省大量内存，并减少编码/解码的需要。Gabby计划在罗马之行回来后继续这项工作，预计不会太久就能进行测试。

4. 行动计划：
   - Gabby将继续他的Snapmapper项目，并在下次会议前提供更新。
   - 其他成员将继续审查和测试现有更新，并在必要时提供反馈。
   - 下一次会议将在一周后召开，届时将进一步讨论这些主题和任何新的进展。