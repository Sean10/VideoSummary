---
title: "Ceph Crash Telemetry - Observability in Action"
date: 2022-11-09
updated: 2022-11-10
tags:
categories:
- "视频总结"
subtitle: tech
---


### 会议纪要

#### 会议主题：Telemetry项目更新，重点讨论Crash Telemetry

#### 会议时间：[会议日期]

#### 参会人员：[参会人员名单]

#### 会议内容总结：

1. **Telemetry项目概述**
   - Telemetry服务允许集群报告匿名和非识别数据，包括安装和配置信息。
   - 数据汇总后在公共仪表板上展示，网址为`Telemetry Dash public.sef.com`。
   - 用户可以通过CLI命令`self telemetry on`或在Ceph管理仪表板中选择加入。

2. **Telemetry通道介绍**
   - **Basic Channel**：包含集群的基本信息，如内核版本、集群大小、守护进程数量等，默认开启。
   - **Crash Channel**：提供集群中所有崩溃的信息，包括崩溃的回溯和在Ceph代码中发生的位置，默认开启。
   - **Device Channel**：收集集群中所有驱动器的健康指标，主要是SMART数据和NVMe指标，默认开启。
   - **Ident Channel**：允许用户选择性地识别自己，默认关闭。
   - **Perf Channel**：在Quincy版本中新增，包含集群性能计数器的信息，默认关闭。

3. **隐私和数据安全**
   - 用户需要明确选择加入Telemetry报告，同意CDLA共享许可。
   - 报告不包含敏感或识别数据，如池或主机名、对象名或内容。
   - 集群被分配一个随机的UID，不报告FSID，不存储IP地址。

4. **Telemetry的动机和好处**
   - 对开发者：了解功能使用情况，升级节奏，版本采用率，硬件部署情况，设备健康指标数据集，崩溃数据帮助优先处理常见问题。
   - 对用户：验证安装，预先防范设备故障，减少停机时间，自动化处理崩溃报告节省时间。

5. **Telemetry架构和流程**
   - 崩溃时，守护进程生成崩溃转储并写入本地磁盘，然后重启。
   - 每个节点上的crash daemon定期检查并将新崩溃报告给Ceph集群的crash manager模块。
   - 用户选择加入Telemetry和Crash Channel后，Telemetry每天查询数据库并编译报告发送至后端。

6. **后端处理和分析**
   - 后端使用crash processor处理崩溃报告，去除偏移和地址，应用搜索和替换模式，计算签名，并更新数据库。
   - Redmine bot查询数据库，将崩溃签名映射到Redmine问题，更新或创建新问题，并识别回归问题。

7. **用户交互和反馈**
   - 用户可以通过Redmine跟踪崩溃报告，未来将有工具提供集群崩溃的总体视图。
   - 对于非bug崩溃，建议参考Redmine和博客文章中的故障排除分析。

8. **仪表板演示和成功案例**
   - 内部仪表板允许搜索整个数据库，查看崩溃趋势，受影响的集群信息等。
   - 成功案例包括Telemetry bot自动发现并报告问题，开发团队据此修复并回溯到旧版本。

#### 后续行动计划：
- 继续优化Telemetry报告和后端处理流程。
- 开发更多用户友好的工具，帮助用户跟踪和管理集群崩溃。
- 鼓励用户选择加入Telemetry服务，提供更多支持和反馈。

#### 会议结束语：
感谢所有参与者的积极参与和贡献，Telemetry项目已经取得显著成效，期待未来更多的合作和改进。