---
title: "All things in Moderation | Ceph Days London 2024"
date: 2024-08-23
updated: 2024-08-24
tags:
categories:
- "视频总结"
subtitle: tech
---



**会议纪要**

**会议时间**： [请填写会议时间]
**会议地点**： [请填写会议地点]
**参会人员**： Jack（Bloomberg存储工程团队）
**会议主题**： 在SEF对象存储上应用集群级服务质量（QoS）技术的经验分享

**会议内容**：

**1. 背景**

- Bloomberg拥有大量SEF存储集群，分布在生产、开发、测试和遗留环境中。
- 由于集群处理请求和数据传输量巨大，需要实施QoS策略来优化性能和用户体验。

**2. 自定义QoS解决方案**

- 由于现有解决方案无法满足Bloomberg的需求，团队自行开发了软件定义的QoS堆栈。
- 该堆栈旨在实现以下目标：
  - 为用户提供一致的性能体验。
  - 维护集群性能标准。
  - 为每个用户提供可配置的速率限制。
  - 支持多种环境，包括多站点集群。

**3. QoS架构**

- 系统架构包括：
  - 用户
  - SEF集群
  - Haproxy代理（定制版本）
  - 自定义CIS日志服务器
  - Reddis实例（用于存储数据）
  - 策略生成器

**4. 遇到的问题及解决方案**

- **传输限制执行**：
  - 原始系统为完全被动式，只有在用户超过限制后才会采取措施。
  - 现已改进，通过向Haproxy代理发送超出限制的程度信息，调整暂停时间。
  - 正在探索更主动的解决方案，例如根据实例使用情况调整限制。

- **并发传输**：
  - 用户通过增加机器或硬件来提高传输速度。
  - 需要限制客户端打开的连接数量，以防止资源耗尽。
  - 正在研究防止创建新连接的方法。

- **昂贵请求**：
  - 下载大量对象或列出大存储桶中的对象可能导致性能问题。
  - 需要更深入地分析请求，例如根据服务时间或请求复杂性进行限制。

**5. 未来计划**

- 进一步改进传输限制执行和并发传输问题。
- 研究更智能的请求分析方法，以处理昂贵请求。
- 考虑开源自定义QoS解决方案。

**6. 总结**

- 自定义QoS解决方案在Bloomberg的SEF存储集群中取得了成功。
- 通过不断改进和优化，该解决方案有助于提高性能和用户体验。

**后续行动计划**：

- Jack将分享更多关于QoS架构和实施细节的信息。
- 团队将继续研究改进QoS解决方案的方法。
- 考虑开源自定义QoS解决方案。

**备注**：

- 会议中提到的关键计算机科学/CEPH领域英文原文关键词包括：SEF object storage, cluster wide quality of service, Haproxy, Reddis, rate limiting, connection limiting, expensive requests。