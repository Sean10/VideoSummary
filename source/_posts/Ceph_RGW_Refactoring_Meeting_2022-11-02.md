---
title: "Ceph RGW Refactoring Meeting 2022-11-02"
date: 2023-01-27
updated: 2023-01-27
tags:
categories:
- "视频总结"
subtitle: tech
---


### 会议纪要

#### 会议主题：
- 讨论关于Ceph的多对象删除（multi-delete PR）的实现细节和性能优化。

#### 参会人员：
- Jason
- Corey
- Casey
- Rick
- 其他相关开发人员

#### 主要讨论内容：

1. **多对象删除并发限制**
   - Corey提出在多对象删除操作中，当前实现会为每个对象启动一个新的协程进行并发删除，但需要设置一个上限来限制同时启动的协程数量。
   - 建议引入一个新的配置参数来控制并发协程的数量，以避免对集群造成过大的IOPS压力。
   - Casey建议是否需要单独的配置变量，或可以考虑其他现有的配置方式。

2. **性能问题与优化**
   - Corey提到当前的生产集群使用的是旋转磁盘，且使用了Erasure Coding（8+3），多对象删除操作会导致大量的IOPS，影响集群性能。
   - 提出另一个配置对象的设想，即不让RGW在head对象中存储任何数据，仅存储元数据，以便删除操作可以在NVMe上进行，提高删除操作的性能。
   - 讨论了是否可以通过配置Zone placement来实现这一功能，而不是通过cephconfig变量。

3. **存储类别的交互**
   - 讨论了存储类别（storage classes）的配置，以及如何通过配置不同的存储类别来影响head对象的数据存储。
   - 提到可以通过Bucket级别的配置来设置默认的存储类别，从而影响head对象的数据存储方式。

4. **数据与元数据的存储策略**
   - 讨论了为什么数据需要与head对象一起存储，主要是为了减少或避免额外的RADOS操作，特别是对于小对象。
   - 提出在特定情况下，如使用快速存储（如NVMe）时，可以考虑分离数据和元数据的存储，以提高性能。

#### 决定事项：
- Corey将开启一个新的PR，涉及上述讨论的配置变更，并在现有的PR中添加QoS相关的提交。
- 将继续在GitHub上讨论这些变更的细节。

#### 后续行动计划：
- Corey将提交新的PR并添加相关提交。
- 开发团队将在GitHub上进一步讨论和审查这些变更。

#### 其他事项：
- 提醒开发者注意即将到来的开发者月度会议和虚拟Cephalicon会议。

#### 会议结束：
- 会议在讨论完所有议题后结束，未有其他紧急讨论事项。

---

以上是本次会议的纪要，涵盖了会议的关键细节、讨论的主要议题、决定的事项以及后续的行动计划。