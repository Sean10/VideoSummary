---
title: "CephFS Code Walkthrough: MDS path traversal"
date: 2021-08-23
updated: 2021-08-24
tags:
categories:
- "视频总结"
subtitle: tech
---


### 会议纪要

#### 会议主题：Ceph MDS 部分遍历

#### 会议时间：[具体时间]

#### 参会人员：[参会人员名单]

#### 会议内容总结：

1. **数据结构介绍**：
   - 讨论了MDS部分遍历涉及的三种重要数据结构：
     - **CI Node**：每个文件对应一个CI Node，包含文件的属性和其他信息。
     - **Seed Entry**：目录项的简写，连接inode和文件名或目录名。
     - **CDN Tree**：仅存在于目录的数据结构，用于链接目录下的条目。
   - 引入了**权威MDS**的概念，即特定inode的更改应由权威MDS处理，非权威MDS通常会将请求转发给权威MDS。

2. **代码流程分析**：
   - 详细讲解了路径遍历的代码实现，包括路径遍历例程的定义和使用。
   - 讨论了路径遍历中的三种主要用例：
     - 当在特定路径下创建文件时的情况。
     - 路径涉及快照目录时的情况。
     - 路径中某些标识不存在时的情况。
   - 强调了在路径遍历中，客户端通常通过查找操作触发路径遍历，而MDS则通过MD请求结构维护请求的上下文。

3. **实际代码演示**：
   - 通过GDB调试工具，展示了单个MDS情况下的路径遍历实际操作。
   - 演示了如何处理路径遍历中的查找操作和创建操作，包括如何处理查找失败的情况。
   - 讨论了涉及快照目录的路径遍历，特别是如何处理快照目录中的文件查找。

4. **问题与讨论**：
   - 讨论了Bloom过滤器在路径查找中的应用，作为一种优化手段，用于快速确定路径是否存在。
   - 提及了LRU缓存算法在数据结构中的实现，特别是在inode和CDN树中的应用。

#### 决定事项：
- 确认了路径遍历的基本流程和关键数据结构。
- 确定了需要进一步深入研究的边缘案例和复杂情况。

#### 后续行动计划：
- 继续深入研究路径遍历的复杂用例，特别是涉及多个MDS的情况。
- 准备下一次会议，讨论更详细的技术实现和优化策略。

#### 会议结束：
- 会议在提问和讨论环节后顺利结束，感谢所有参与者的积极参与和贡献。

---

**备注**：会议中提到的技术细节和代码实现部分，建议参会者会后进一步查阅相关文档和代码库，以加深理解。