---
title: "Ceph RGW Refactoring Meeting 2024-01-24"
date: 2024-01-24
updated: 2024-01-25
tags:
categories:
- "视频总结"
subtitle: tech
---


### 会议纪要

#### 会议主题：
1. 用户对Topic的授权问题
2. Topic迁移问题

#### 讨论内容：

##### 1. 用户对Topic的授权问题
- **问题描述**：当前系统中，任何用户都可以覆盖其他用户的Topic，没有进行用户身份验证。
- **解决方案**：
  - 引入全局配置参数，当没有设置策略时，不进行任何策略检查。
  - 建议保持向后兼容性，通过文档说明用户需要设置策略以防止这种情况。
  - 对于新系统，可以设置全局标志为true，强制执行正确的授权行为。
  - 对于Topic的创建，无论全局标志如何，只要用户存在，就进行策略检查。
  - 对于发布权限，依赖全局参数，默认允许发布，但管理员可以更改标志以强制执行发布策略。
- **决定事项**：
  - 对于Topic的创建和覆盖，进行严格的策略检查。
  - 发布权限依赖全局参数，默认允许发布。
  - 需要编写详细的发布说明，以通知用户这一变更。

##### 2. Topic迁移问题
- **问题描述**：讨论是否在rgw启动或领域重载时进行迁移，还是作为外部工具进行。
- **解决方案**：
  - 建议在启动时进行迁移，以减少对用户的影响。
  - 对于通知迁移，建议懒惰迁移，即在访问时进行迁移。
  - 需要处理多站点配置中的元数据一致性问题。
- **决定事项**：
  - 在启动时进行Topic迁移。
  - 对于通知迁移，采用懒惰迁移策略，并在元数据主站点进行。
  - 需要构建迁移逻辑以容忍现有的元数据，避免冲突。

#### 后续行动计划：
- 编写详细的发布说明，通知用户关于Topic授权和迁移的变更。
- 更新现有Tracker问题，根据讨论结果调整PR。
- 考虑构建一个外部工具，帮助用户在升级前手动同步非主站点的Topic和通知配置。

#### 会议总结：
会议讨论了关于Topic授权和迁移的两个主要问题，并就如何保持向后兼容性、如何进行迁移以及如何处理多站点配置中的元数据一致性问题达成了共识。后续将根据会议决定编写发布说明，并考虑构建外部工具以帮助用户进行迁移。

---

**参会人员**：[参会人员名单]
**会议时间**：[会议日期和时间]
**会议记录人**：[记录人姓名]