---
title: "CDS Reef: Rados Gateway"
date: 2022-04-14
updated: 2022-04-14
tags:
categories:
- "视频总结"
subtitle: tech
---


### 会议纪要

#### 会议概述
本次会议主要讨论了Ceph分布式存储系统中RGW（RADOS Gateway）的多个高层次项目和进展，包括新功能的开发、现有功能的优化以及测试和性能提升等方面。

#### 主要议题
1. **Zipper项目**
   - **动态加载存储库**：计划允许从共享库中加载存储库，而不是内置在Ftree中，以更好地支持外部项目的集成。
   - **独立模式**：探索基于DB存储的独立模式，以便在小规模配置中运行，无需连接到集群。
   - **过滤层**：开发一个过滤层，通过包装另一个存储接口并传递所有调用，实现数据缓存和其他中间层策略。

2. **S3 Select**
   - **JSON支持**：正在进行对JSON格式对象的查询支持，计划在Reef版本中完成。
   - **AeroFlight集成**：虽然与S3 Select不是直接相关，但AeroFlight作为一个前端，理解列式数据集，并有一个内部接口Flight SQL，可以进行各种限制操作。

3. **异步重构项目**
   - **减少线程数**：目标是能够以远少于默认的512个线程运行，Adam在Neo-Rados客户端的工作与此紧密相关。

4. **可观测性和追踪**
   - **Jaeger集成**：已经进行了大量工作将Jaeger集成到Ceph中，构建追踪原语并测试其性能。
   - **条件追踪**：正在探索基于Lua的条件追踪，以便在特定条件下动态启用追踪。

5. **多站点（Multi-Site）项目**
   - **动态重分片**：正在进行动态重分片的工作，以提高多站点配置的可扩展性。
   - **同步公平性**：目标是改进多个网关实例之间的协作，优化同步过程。

6. **工作负载测试**
   - **测试重写**：考虑重写多站点测试，可能使用Golang或其他支持并发性的语言。
   - **性能和规模测试**：讨论了使用MinIO Warp工具进行工作负载生成，以及在ToothAlley环境中进行大规模测试的可能性。

7. **HTTP/3支持**
   - **长期目标**：计划在RGW中添加HTTP/3支持，以实现更低的延迟和更好的性能。

8. **同步信息提供者**
   - **抽象同步API**：工作包括抽象同步API，以便支持非RGW数据源，如AWS S3。

9. **功能弃用**
   - **OMAP日志**：讨论了弃用OMAP日志的可能性，特别是在数据日志方面。

#### 决定事项
- 继续推进Zipper项目中的各项功能开发。
- 完成S3 Select的JSON支持和AeroFlight集成。
- 完成异步重构项目，减少线程数。
- 完善可观测性和追踪功能，特别是条件追踪的实现。
- 完成多站点项目的动态重分片和同步公平性改进。
- 探索使用Golang重写多站点测试，并使用MinIO Warp进行工作负载测试。
- 开始HTTP/3支持的初步研究。
- 继续推进同步信息提供者的工作，并在动态重分片完成后重新审视。
- 考虑在Reef版本中弃用OMAP日志。

#### 后续行动计划
- 继续开发和测试Zipper项目中的功能。
- 完成S3 Select的JSON支持和AeroFlight集成。
- 完成异步重构项目，减少线程数。
- 完善可观测性和追踪功能，特别是条件追踪的实现。
- 完成多站点项目的动态重分片和同步公平性改进。
- 探索使用Golang重写多站点测试，并使用MinIO Warp进行工作负载测试。
- 开始HTTP/3支持的初步研究。
- 继续推进同步信息提供者的工作，并在动态重分片完成后重新审视。
- 考虑在Reef版本中弃用OMAP日志。

#### 其他讨论
- 讨论了在ToothAlley环境中进行大规模测试的可能性。
- 讨论了在Ceph Messenger中添加QUIC支持的可能性。
- 讨论了Deprecating features，特别是OMAP日志的支持。

#### 会议结束
会议在讨论了所有议题后结束，Casey计划将新内容添加到Trello的Backlog中，并鼓励大家继续参与后续的讨论和开发工作。