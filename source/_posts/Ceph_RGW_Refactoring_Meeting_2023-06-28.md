---
title: "Ceph RGW Refactoring Meeting 2023-06-28"
date: 2023-07-03
updated: 2023-07-03
tags:
categories:
- "视频总结"
subtitle: tech
---


### 会议纪要

#### 会议概要
本次会议主要讨论了Ceph Reef版本的更新、异步请求重构、线程池优化以及从librados迁移到Neo-rados的计划。

#### 主要议题
1. **Reef版本更新**
   - 目前计划将两个问题作为Reef版本的阻塞项：
     - 版本化对象一致性问题，Corey Snyder正在处理。
     - 多站点中加密对象损坏问题，Marcus已识别压缩为潜在原因。
   - 需要解决这些问题，否则会导致功能退化。

2. **异步请求重构**
   - 最近合并了一个大型PR，扩展了可选的异步处理路径。
   - 计划引入回归测试，确保所有阻塞的librados调用都被发现并防止新增。
   - 讨论了如何在编译时和运行时检查阻塞调用，特别是在Ezio线程中。

3. **线程池优化**
   - 当前线程池有512个线程，数量过多。
   - 计划在消除所有阻塞调用后，大幅降低线程池大小，可能调整为核心数的一个小倍数。

4. **从librados迁移到Neo-rados**
   - Jason Dillerman在RGW团队中发现切换到Neo-rados有显著性能提升。
   - 讨论了逐步转换的可能性，以及如何管理同时使用librados和Neo-rados的过渡期。

#### 决定事项
- 需要解决版本化对象一致性和加密对象损坏问题，以避免功能退化。
- 引入回归测试，确保异步请求的正确性和防止新增阻塞调用。
- 计划降低线程池大小，并进行性能测试以确定最佳大小。
- 逐步从librados迁移到Neo-rados，可能采用分系统逐步转换的方式。

#### 后续行动计划
- 继续跟踪和解决版本化对象一致性问题。
- 与Marcus合作解决加密对象损坏问题。
- 实施回归测试，确保异步请求的非阻塞性。
- 进行线程池大小调整的性能测试。
- 开始逐步从librados迁移到Neo-rados的工作，可能由calpesh负责。

#### 其他讨论点
- 讨论了如何处理阻塞的后端存储，如SQLite，以及如何在未来可能完全移除null yield时保持系统的可扩展性。

#### 会议结束
会议在讨论完所有议题后结束，感谢所有参与者的贡献。