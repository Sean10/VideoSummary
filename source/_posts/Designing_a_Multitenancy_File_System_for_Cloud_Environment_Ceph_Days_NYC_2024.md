---
title: "Designing a Multitenancy File System for Cloud Environment | Ceph Days NYC 2024"
date: 2024-05-23
updated: 2024-05-23
tags:
categories:
- "视频总结"
subtitle: tech
---


### 会议纪要

**会议主题：** 利用开源分布式存储系统Ceph为云环境构建多租户文件系统

**主讲人：** Mitch Hall（45 Drives首席架构师）、Brett KY（45 Drives技术总监）

**会议内容总结：**

1. **项目背景与需求：**
   - 一家《财富》100强公司寻求新的云解决方案，用于远程编辑和存储媒体娱乐内容。
   - 需求包括多租户支持、存储分层（HDD和SSD）、弹性扩展、数据加密、自动化管理以及支持NFS、SMB、快照和配额等功能。

2. **主要挑战：**
   - **可扩展性：** 需要支持数百至数千个多租户工作站。
   - **多租户支持：** 文件系统本身不天然支持多租户。
   - **数据加密：** 需要实现数据静态加密。
   - **自动化：** 需要从零开始开发自动化工具。
   - **文件系统支持：** 需要支持多种文件系统功能。

3. **硬件与软件选择：**
   - 硬件：45 Drives提供的存储节点和计算节点，每个存储节点配备30个硬盘槽和22个SSD槽。
   - 软件：Rocky Linux作为操作系统，Ceph Octopus作为分布式存储系统，Proxmox v7.1用于虚拟化。

4. **数据隔离与安全：**
   - 使用Ceph的RADOS命名空间实现数据隔离，确保每个租户只能访问自己的数据。
   - 通过配置密钥环限制租户访问权限，确保数据安全。

5. **加密与自动化：**
   - 使用DM-Crypt和自加密驱动器实现数据加密。
   - 开发自动化脚本和udev规则，确保驱动器在系统启动时正确解锁。

6. **性能测试：**
   - 构建了测试环境，使用Filebench进行多种性能测试，包括随机读写、顺序读写和小文件操作。
   - 测试结果显示，虚拟化网关在处理随机IO时性能稳定，且延迟保持在较低水平。

7. **部署与挑战：**
   - 在英国的数据中心实际部署时，发现网络配置与预期不符，通过现场调整代码解决了问题。

8. **未来计划：**
   - 考虑将虚拟化层替换为容器化，以提高灵活性和效率。
   - 改进多MDS管理，实现更自动化的MDS分配和扩展。

**后续行动计划：**
- 继续优化自动化工具和配置管理。
- 探索容器化解决方案，提高系统灵活性和可管理性。
- 完善MDS管理策略，确保高性能和稳定性。

**备注：**
- 会议中提到的技术细节和工具包括Ceph、Rocky Linux、Proxmox、Samba、Ansible、Terraform等，这些关键词在总结中保留以供参考。